# coding: utf-8

from inspect import getsource
from datetime import datetime

from OpenSSL.crypto import FILETYPE_PEM, TYPE_RSA, X509, PKey, dump_privatekey, dump_certificate

key = PKey()
key.generate_key(TYPE_RSA, 2048)

cert = X509()
issuer = cert.get_issuer()
subject = cert.get_subject()

for dn in [issuer, subject]:
    dn.C = b"TR"
    dn.ST = b"Çorum"
    dn.L = b"Başmakçı"
    dn.CN = b"localhost"
    dn.O = b"Twisted Matrix Labs"
    dn.OU = b"Automated Testing Authority"
    dn.emailAddress = b"security@twistedmatrix.com"

cert.set_serial_number(datetime.now().toordinal())
cert.gmtime_adj_notBefore(0)
cert.gmtime_adj_notAfter(60 * 60 * 24 * 365 * 100)

cert.set_pubkey(key)
cert.sign(key, b"sha1")

import __main__
source = getsource(__main__)
source = source.split(b"\n" + b"-" * 5)[0].rsplit(b"\n", 1)[0]
with open(b"server.pem", "wb") as fObj:
    fObj.write(source)
    fObj.write(b"\n")
    fObj.write(b"'''\n")
    fObj.write(dump_privatekey(FILETYPE_PEM, key))
    fObj.write(dump_certificate(FILETYPE_PEM, cert))
    fObj.write(b"'''\n")
'''
-----BEGIN PRIVATE KEY-----
MIIEvwIBADANBgkqhkiG9w0BAQEFAASCBKkwggSlAgEAAoIBAQCyHscXffwghQ8W
uo5bvbg4KDEtWIXiY3tL5wbMocbKaCBQ1JgAv1jp7C4ka5yAYBQDmFT6dHdzAgOS
KrzqtH5tQl0pVuSAHOERDoSONk7mhNi+rMLuKcSFLBExrHkuhpLQbWtWf5/ohG0A
JLI/aiRjNWkQpX1glHU4aRSl+yUPq1NEP+R2CH+NN66BK2HK1MaYE2RFQ9WIMFdD
1quhzQ3+GgyN4vSgkKKMeOsYJXj0MGs2AdmTYyajz3I0BnHRX5dnX2KQ249kNSEC
YNWOPAIOkEb5ZA4KJNklspHD1rAYjEawelwda7y8Nu+1YXFjVIJXKvJ38ybvVWCb
hKkwpkWvAgMBAAECggEAVfD9tLsH3JT2y8ulhmRKr2XNHIj6yFmhkuTcZf2kkeKd
vQJmeO3aM7vOI6p8b4BsB7QHRHTPcYFGQc83KbN+0K7Vjm2rgJjuizFLCebwOM9e
WNm4j/s9I9g4T5RdP/KUgdZZlPmtKR5EDW6nRmurNOb/U5XVobTfviENYmyD3EPK
nJhh26YdPPg8RgJSLy5p6fWp80y7/4UKFUvrGO/ug6JGxyPMyq2oxXiasVCvHLsr
k+t0gcqXLNkCXkgc2e+9HB5FLwyGXpj0x57HRkz208tX7MYxkWfjuPDkUXQv/7dG
DnE8TeU5XfP4QPlwxpdiZ/AQYqOJQvwJNEY5ouWRAQKBgQDbY1gesintY+iH0Mdl
ktPinMoYHrzSFhHotE5O9q9tbx85F3plhQ4bHVtw2W4ZnwtEmpemm8jc2oYE+dGL
C+nsiqHMVjdTD6GEWRbRp+5YuaImLDld9TzDRlF5qRGu6ytMSM5ogTStW49h6d79
R8oa/kq6Y3RetJmnussc07uzLwKBgQDP2GWJ1tBjSymPWcSTX3t2JEVncShnDCJ7
qDeNw1agbKWW1lDSitUvNDsREFswbgWAYbLx/NTzh3c9Ulg9KYD6HTJqhl9xCJoo
kdjV6hL5LOL1RNbT7vlBeneZP1GBSY7yzBD/l1ATAMnUh3dU8j4CzUAap2dgs//I
YxTOS3v1gQKBgQCFDuevFlefhuzNEq8cx8SCuJ1Jq7rRoFkUTecAtVUIhlDli3vM
frpjb5a6BuVj3LY00Z4QioN0j4ShF/Mi5gLmV95x1AiR8/T+FBpm5fcFEPFrPX89
oTNNLCTWKNh0wmTsS2wErfiI+/Mma3W3IAdP/9LK4O7/UYGv3Pa7cR9yOQKBgQCD
di/jG0f7RdMnpHO9cys38oEjiGMxqm81H5TjyaXFGnMyEKRWRxHIJZUmmd3TqAM6
zJDOlkhrMEevNaIyLUoy6Ly2u/8qE3LOLlGkG8WcbVOwJrZqnkBxtfBnsbDvwYL0
9zXZM++l1V3TW0uTIxUt2HyvXyr382HZcTH7uarSAQKBgQCMAV51LiHApwZm8S4B
i0nK7ic2PqgRR58eJ4z2bEQBzrxveDEYhj3heOWoHSCjp9MPi7C/dQEwj0uuYuIH
77XJlyAMgqsFHKU8myeTSBXR7NU6rMdzegctzggKKuRiqwjGIdLRhNcZy5yK7At5
zjgdCib02bzY+Fz9hW/89iI10A==
-----END PRIVATE KEY-----
-----BEGIN CERTIFICATE-----
MIID6DCCAtACAws8FjANBgkqhkiG9w0BAQUFADCBtzELMAkGA1UEBhMCVFIxDzAN
BgNVBAgMBsOHb3J1bTEUMBIGA1UEBwwLQmHFn21ha8OnxLExEjAQBgNVBAMMCWxv
Y2FsaG9zdDEcMBoGA1UECgwTVHdpc3RlZCBNYXRyaXggTGFiczEkMCIGA1UECwwb
QXV0b21hdGVkIFRlc3RpbmcgQXV0aG9yaXR5MSkwJwYJKoZIhvcNAQkBFhpzZWN1
cml0eUB0d2lzdGVkbWF0cml4LmNvbTAgFw0xNjExMTAwODMzNDFaGA8yMTE2MTAx
NzA4MzM0MVowgbcxCzAJBgNVBAYTAlRSMQ8wDQYDVQQIDAbDh29ydW0xFDASBgNV
BAcMC0JhxZ9tYWvDp8SxMRIwEAYDVQQDDAlsb2NhbGhvc3QxHDAaBgNVBAoME1R3
aXN0ZWQgTWF0cml4IExhYnMxJDAiBgNVBAsMG0F1dG9tYXRlZCBUZXN0aW5nIEF1
dGhvcml0eTEpMCcGCSqGSIb3DQEJARYac2VjdXJpdHlAdHdpc3RlZG1hdHJpeC5j
b20wggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQCyHscXffwghQ8Wuo5b
vbg4KDEtWIXiY3tL5wbMocbKaCBQ1JgAv1jp7C4ka5yAYBQDmFT6dHdzAgOSKrzq
tH5tQl0pVuSAHOERDoSONk7mhNi+rMLuKcSFLBExrHkuhpLQbWtWf5/ohG0AJLI/
aiRjNWkQpX1glHU4aRSl+yUPq1NEP+R2CH+NN66BK2HK1MaYE2RFQ9WIMFdD1quh
zQ3+GgyN4vSgkKKMeOsYJXj0MGs2AdmTYyajz3I0BnHRX5dnX2KQ249kNSECYNWO
PAIOkEb5ZA4KJNklspHD1rAYjEawelwda7y8Nu+1YXFjVIJXKvJ38ybvVWCbhKkw
pkWvAgMBAAEwDQYJKoZIhvcNAQEFBQADggEBAHSklDritJ/KW9h2bfpw1lJWrrVQ
RIqWJEfJc+R508RUlx+/T13oWGE1Qv8tiT5GKDtUNtzqFIWVLZle2uHo9fjhZZpb
WtAsOzU7R5D8WwLW0nyDL+B6LCnso35Cb2W/qIqWTgU4HXQZ7XI/IGOb9W96RCLt
BXjuPghp55HSJYmHMUDAS9kHjtYV2Ds/FIS1OtDSzckyyZ8v06ck6EONbVWAzBsI
8tvuNmXyY/3F6TudTNJ804ZmbSGz0ge2DsTU3zOX5kNE+7gdW/CrcwludLfU7Y5y
TnsFAOBcf67uw/gfIFv9BmOrmgd9Egvs0HV19w8uJzawqtv15m5W0J/5iIo=
-----END CERTIFICATE-----
'''
